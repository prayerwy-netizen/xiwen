# 曦文礼物兑换系统 🎁

一款以"家长记账、孩子查看"为核心的家庭积分管理PWA应用，将纸质积分表数字化，帮助家长科学激励孩子，培养良好行为习惯和目标管理能力。

## 📱 产品特色

- **双角色设计**：孩子查看模式 + 家长管理模式，PIN码保护
- **视觉激励**：金色小元宝、日历仪表盘、礼花动画、番茄时钟
- **快速记账**：家长心算后直接录总分，支持历史日期补录
- **目标管理**：礼物兑换申请-批准流程，培养延迟满足能力
- **云端同步**：可选集成Supabase云数据库，多设备数据同步（v7新增）
- **无需安装**：PWA应用，浏览器直接访问，跨平台使用

## 🚀 快速开始

### 在线访问

直接用浏览器打开 `index.html` 文件即可使用！

### 本地运行

1. 下载或克隆项目到本地
2. 用浏览器打开 `index.html`
3. 开始使用！

**默认PIN码**：`1234`

## 📂 项目结构

```
曦文打卡器/
├── index.html              # 孩子端 - 首页（日历仪表盘）
├── gifts.html              # 孩子端 - 礼物商城
├── records.html            # 孩子端 - 我的记录
├── parent-login.html       # 家长PIN码验证
├── parent-record.html      # 家长 - 快速记账
├── parent-tasks.html       # 家长 - 任务管理
├── parent-gifts.html       # 家长 - 礼物管理
├── parent-approval.html    # 家长 - 兑换审批
├── parent-settings.html    # 家长 - 设置
├── css/
│   ├── common.css          # 公共样式（CSS变量、重置、通用类）
│   └── components.css      # 组件样式（按钮、输入框、卡片等）
├── js/
│   └── common.js           # 公共脚本（数据管理、工具函数）
└── README.md               # 项目文档
```

## 🎯 功能说明

### 孩子端功能

#### 1. 首页（日历仪表盘）
- **小元宝总分显示**：顶部金色容器，实时显示当前总积分
- **日历仪表盘**：月度日历视图，每日积分一目了然
- **日期详情**：点击日期查看当天每项任务得分情况
- **月份切换**：左右箭头切换查看不同月份

#### 2. 礼物商城
- **礼物展示**：卡片式网格布局，展示所有可兑换礼物
- **积分对比**：实时显示当前积分和礼物所需积分
- **申请兑换**：积分充足时可申请兑换，等待家长批准
- **状态提示**：积分不足/审批中/可兑换，状态清晰

#### 3. 我的记录
- **记录列表**：按时间倒序显示所有积分记录
- **本月统计**：展示本月记录总数、正向得分、负向扣分
- **筛选功能**：可按全部/正向/负向筛选记录
- **月份分组**：自动按月份分组显示，清晰明了

### 家长端功能

#### 1. PIN码验证
- **4位数字PIN码**：保护家长管理权限
- **错误锁定**：3次错误后锁定1分钟
- **数字键盘**：友好的输入界面

#### 2. 快速记账
- **任务选择**：下拉列表选择预设任务
- **快速输入**：支持快捷按钮（+1/+2/+3/+5/+10/-1/-2/-5）
- **备注功能**：可选填写备注信息（最多200字）
- **自动填充**：选择任务后自动填充参考分数

#### 3. 任务管理
- **新增任务**：自定义任务名称、单位、分数和类型
- **编辑任务**：修改任务参数，灵活调整
- **启用/禁用**：一键切换任务状态
- **删除任务**：移除不再使用的任务
- **17个内置模板**：首次使用自动加载

#### 4. 礼物管理
- **新增礼物**：添加礼物名称、图片和所需积分
- **图片管理**：支持输入网络图片URL
- **编辑礼物**：修改礼物信息
- **启用/禁用**：控制礼物在商城的显示
- **删除礼物**：移除礼物及相关申请

#### 5. 兑换审批
- **待审批列表**：查看孩子提交的兑换申请
- **历史记录**：查看已批准/已拒绝的申请
- **批准操作**：确认兑换，自动扣除积分
- **拒绝操作**：拒绝申请，积分不变
- **礼花动画**：批准时触发祝贺动画

#### 6. 设置
- **积分初始化**：将纸质记录的积分导入系统
- **修改PIN码**：更改家长验证PIN码
- **数据导出**：备份所有数据到JSON文件
- **数据导入**：从备份文件还原数据
- **清空数据**：重置系统（危险操作）
- **数据统计**：显示记录数、任务数、礼物数

## 💾 数据管理

### 数据存储

#### 本地存储模式（默认）
- 使用浏览器 `localStorage` 存储数据
- 数据持久化保存，刷新不丢失
- 支持数据导出/导入（JSON格式）

#### 云同步模式（可选 - v7新增）
- 集成 Supabase 云数据库
- 数据永久保存在云端
- 多设备自动同步（手机、平板、电脑）
- 支持本地数据一键迁移到云端
- 详见：[Supabase快速配置.md](Supabase快速配置.md)

### 数据模型

#### 任务表（tasks）
```javascript
{
  id: 1,
  name: '跳绳',
  unit: '10个/次',
  score: 1,
  type: 'positive', // positive/negative
  enabled: true
}
```

#### 积分记录表（records）
```javascript
{
  id: 1234567890,
  taskId: 1,
  taskName: '跳绳',
  score: 24,
  note: '今天超额完成',
  date: '2025-01-07T10:30:00.000Z'
}
```

#### 礼物表（gifts）
```javascript
{
  id: 1,
  name: '电话手表',
  image: 'https://...',
  score: 700,
  enabled: true
}
```

#### 兑换申请表（requests）
```javascript
{
  id: 1234567890,
  giftId: 1,
  giftName: '电话手表',
  score: 700,
  status: 'pending', // pending/approved/rejected
  date: '2025-01-07T10:30:00.000Z'
}
```

## 🎨 设计规范

### 色彩系统
- **主色调**：天空蓝 `#4A90E2`
- **强调色**：金黄色 `#FFD700`（小元宝、积分）
- **成功色**：`#52C41A`
- **警告色**：`#FAAD14`
- **错误色**：`#F5222D`

### 字体规范
- **孩子端大标题**：48px / Bold
- **家长端标题**：24px / Semibold
- **正文**：16-18px / Regular
- **辅助文字**：12-14px / Regular

### 间距系统
- 基础单位：8px
- 小间距：8px
- 标准间距：16px
- 中等间距：24px
- 大间距：32px

## 🔧 技术栈

- **前端**：HTML5 + CSS3 + 原生JavaScript
- **架构**：MPA（多页应用）
- **样式**：CSS变量 + Flexbox + Grid
- **存储**：LocalStorage + Supabase（可选）
- **云数据库**：Supabase PostgreSQL（v7新增）
- **兼容性**：Chrome 90+, Safari 14+, Edge 90+

## 📱 响应式设计

- **移动端**（≤767px）：单列布局，大字号
- **平板端**（768-1024px）：优化重点，2-3列布局
- **桌面端**（≥1025px）：最大宽度1200px，居中显示

## ⚡ 性能优化

- **首屏加载**：关键CSS内联，≤2秒加载完成
- **图片优化**：懒加载，单张≤500KB
- **动画优化**：使用CSS transform（GPU加速）
- **离线可用**：PWA Service Worker支持（待添加）

## 🛠 开发指南

### 添加新任务

编辑 `js/common.js`，在 `defaultTasks` 数组中添加：

```javascript
{
  id: 19,
  name: '整理书桌',
  unit: '1次',
  score: 2,
  type: 'positive',
  enabled: true
}
```

### 修改默认PIN码

编辑 `js/common.js`，修改：

```javascript
localStorage.setItem('xiwen_pin', '1234'); // 改为你的PIN码
```

### 自定义颜色

编辑 `css/common.css`，修改CSS变量：

```css
:root {
  --primary-color: #4A90E2; /* 改为你喜欢的颜色 */
  --gold-color: #FFD700;
}
```

## 🐛 常见问题

### 1. 数据丢失了？
- 检查浏览器是否清除了缓存
- 使用"设置 > 数据备份"功能定期备份

### 2. 忘记PIN码？
- 打开浏览器开发者工具（F12）
- 在Console中输入：`localStorage.setItem('xiwen_pin', '1234')`
- 刷新页面，使用新PIN码登录

### 3. 页面显示不正常？
- 清除浏览器缓存后刷新
- 使用Chrome/Safari/Edge最新版本
- 检查是否启用了JavaScript

### 4. 如何重置所有数据？
- 打开浏览器开发者工具（F12）
- 在Console中输入：`localStorage.clear()`
- 刷新页面即可

## ✅ 已完成功能

- [x] 孩子端首页（日历仪表盘）
- [x] 孩子端礼物商城
- [x] 孩子端我的记录
- [x] 孩子端番茄时钟（v6）
- [x] 家长PIN码验证
- [x] 家长快速记账
- [x] 家长快速记账日期选择（v7）
- [x] 家长任务管理
- [x] 家长礼物管理
- [x] 家长兑换审批
- [x] 家长设置（积分初始化、修改PIN码、数据备份）
- [x] Supabase云数据库集成（v7）
- [x] 云数据同步（v7）
- [x] 数据迁移工具（v7）
- [x] 礼花动画效果

## 📝 待开发功能

- [ ] PWA离线支持（Service Worker）
- [ ] 数据统计分析图表
- [ ] 成就徽章系统
- [ ] 多家庭支持

## 📄 开源协议

MIT License

## 👨‍💻 开发者

AI开发团队 - 废才
- 产品经理：AI Product Manager
- UI/UX设计师：AI UI/UX Designer
- 前端工程师：AI Frontend Developer

## 🙏 致谢

感谢所有使用和支持本项目的家长和孩子们！

---

## 📚 文档索引

- **[README.md](README.md)** - 项目总览（当前文档）
- **[使用说明.md](使用说明.md)** - 功能使用详细说明
- **[部署步骤.md](部署步骤.md)** - GitHub Pages 部署指南
- **[Supabase部署指南.md](Supabase部署指南.md)** - 云数据库完整部署方案
- **[Supabase快速配置.md](Supabase快速配置.md)** - 10分钟快速配置云同步
- **[部署检查清单.md](部署检查清单.md)** - 部署流程检查表

---

**版本**：v7.0
**更新日期**：2025-01-08
**项目状态**：核心功能 + 云同步已完成 ✅

如有问题或建议，欢迎反馈！💬
